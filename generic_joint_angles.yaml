############
## SPACES ##
############

- space: VirtualLab
  alignWithSegment:
    segment: Hips


############
## EVENTS ##
############

# - event: LFS
#   steps:
#     - velocity: LeftToeBase.z => ltb_vel
#     - negate: ltb_vel => ltb_vel_inv
#     - peakFinder: ltb_vel_inv
#       width: 3
#       distance: 100
#       height: 1

# - event: RFS
#   steps:
#     - velocity: RightToeBase.z => rtb_vel
#     - negate: rtb_vel => rtb_vel_inv
#     - peakFinder: rtb_vel_inv
#       width: 3
#       distance: 100
#       height: 1


############
## SERIES ##
############

# --- Pelvis ---

- parameter: Left Pelvic Angles
  set: left
  steps:
    - jointAngle: Hips
      space: VirtualLab
    - multiply: [$prev, [-1, -1, -1]]

- parameter: Right Pelvic Angles
  set: right
  steps:
    - jointAngle: Hips
      space: VirtualLab
    - multiply: [$prev, [-1, 1, 1]]

# --- Hips ---

- parameter: Left Hip Angles
  set: left
  steps:
    - jointAngle: [Hips, LeftUpLeg]
    - multiply: [$prev, [1, -1, 1]]

- parameter: Right Hip Angles
  set: right
  steps:
    - jointAngle: [Hips, RightUpLeg]


# --- Knee ---

- parameter: Left Knee Angles
  set: left
  steps:
    - jointAngle: [LeftUpLeg, LeftLeg]
    - multiply: [$prev, [-1, -1, -1]]

- parameter: Right Knee Angles
  set: right
  steps:
    - jointAngle: [RightUpLeg, RightLeg]
    - multiply: [$prev, [-1, 1, 1]]

# --- Ankle ---

- parameter: Left Ankle Angles
  set: left
  steps:
    - jointAngle: [LeftLeg, LeftFoot]
    - multiply: [$prev, [1, -1, 1]]

- parameter: Right Ankle Angles
  set: right
  steps:
    - jointAngle: [RightLeg, RightFoot]


# --- Upper body ---

- parameter: Trunk Angles_wrt_LAB
  steps:
    - jointAngle: Spine2
      space: VirtualLab
    - multiply: [$prev, [-1,1,1]]

- parameter: Shoulder_Pelvis Angle
  steps:
    - jointAngle: [Hips, Spine2]

# --- Arms ---

- parameter: Left Elbow Angle
  set: left
  steps:
    - angle: [LeftArm, LeftForeArm, LeftHand]
    - convert: $prev
      from: radians
      to: degrees

- parameter: Right Elbow Angle
  set: right
  steps:
    - angle: [RightArm, RightForeArm, RightHand]
    - convert: $prev
      from: radians
      to: degrees

#############
## Metrics ##
#############
